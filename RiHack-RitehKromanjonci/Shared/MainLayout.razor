@using RiHack_RitehKromanjonci.Data;
@using RiHack_RitehKromanjonci.Models;

@inject AppDbContext Context

@inherits LayoutComponentBase
<link href="./css/navbarbutton.css" rel="stylesheet" />
<PageTitle>Sportleaf</PageTitle>

<div class="page">
    <main>
        <div class="top-row px-4" style="background-color: #57cc99; display: flex; justify-content: space-between;">
            
            <div class="top-row px-4" style="background-color: #57cc99;">
                @*LIJEVA STRANA*@
                <div class="nav-item">
                    <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                        <i class="material-icons" style="margin-right: 10px; margin-left: -5px; color: white;" aria-hidden="true">home</i>
                    </NavLink>
                </div>
            </div>

            <div class="top-row px-4" style="background-color: #57cc99;">
                @*DESNA STRANA*@
                @*AKO NIJE ULOGIRAN POKAZI LOGIN, AKO JE ULOGIRAN POKAZI PROFIL, MESSAGES ITD..*@
                @if (showLogin)
                {
                    <div style="margin-left: 20px;">
                        <NavLink class="nav-link button" href="Login" style="color: white;">Prijava</NavLink>
                    </div>
                }
                else
                {
                    <div class="nav-item">
                        <NavLink class="nav-link" href="user_profile" Match="NavLinkMatch.All">
                            <i class="material-icons" style="margin-right: 10px; margin-left: -5px; color: white;" aria-hidden="true">account_circle</i>
                        </NavLink>
                    </div>

                    <div class="nav-item">
                        <NavLink class="nav-link" href="forum" Match="NavLinkMatch.All">
                            <i class="material-icons" style="margin-right: 10px; margin-left: -5px; color: white;" aria-hidden="true">chat</i>
                        </NavLink>
                    </div>

                    <div class="nav-item">
                        <NavLink class="nav-link" href="options" Match="NavLinkMatch.All">
                            <i class="material-icons" style="margin-right: 10px; margin-left: -5px; color: white;" aria-hidden="true">settings</i>
                        </NavLink>
                    </div>

                    <div style="margin-left: 20px;">
                        <button class="button" onclick="@(() => {showLogin = true; StateHasChanged();})">Odjava</button>
                    </div>
                }
                

                
            </div>
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>


@code{
    private User? loggedUser { get; set; }
    private bool showLogin { get; set; }

    protected override async Task OnInitializedAsync()
    {

        loggedUser = Context.Users.FirstOrDefault()!;

        if(loggedUser is null)
        {
            showLogin = true;
        }
        else
        {
            showLogin = false;
        }

        await base.OnInitializedAsync();
    }
}
